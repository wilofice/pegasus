2025-07-21 02:25:05,533 - __main__ - INFO - Starting Pegasus Brain Celery worker...
 
 -------------- celery@mac-1.home v5.5.3 (immunity)
--- ***** ----- 
-- ******* ---- macOS-15.5-arm64-arm-64bit 2025-07-21 02:25:10
- *** --- * --- 
- ** ---------- [config]
- ** ---------- .> app:         pegasus_brain:0x105d6a710
- ** ---------- .> transport:   redis://localhost:6379/0
- ** ---------- .> results:     postgresql://pegasus_user:**@localhost:5432/pegasus_db
- *** --- * --- .> concurrency: 2 (solo)
-- ******* ---- .> task events: ON
--- ***** ----- 
 -------------- [queues]
                .> default          exchange=default(direct) key=default
                .> entity_extraction exchange=nlp(direct) key=nlp.entities
                .> graph_building   exchange=indexing(direct) key=indexing.graph
                .> plugin_execution exchange=plugins(direct) key=plugin.execute
                .> transcript_processing exchange=transcript(direct) key=transcript.processing
                .> vector_indexing  exchange=indexing(direct) key=indexing.vector

[tasks]
  . workers.celery_app.health_check
  . workers.tasks.conversation_processing_tasks.process_conversation_history
  . workers.tasks.plugin_executor.execute_plugins_for_transcript
  . workers.tasks.plugin_executor.execute_single_plugin
  . workers.tasks.plugin_executor.get_plugin_status
  . workers.tasks.plugin_executor.reload_plugin
  . workers.tasks.transcript_processor.process_knowledge_base
  . workers.tasks.transcript_processor.process_transcript
  . workers.tasks.transcript_processor.reprocess_transcript
  . workers.tasks.transcription_tasks.transcribe_audio

2025-07-21 02:25:10,809 - celery.worker.consumer.connection - INFO - Connected to redis://localhost:6379/0
2025-07-21 02:25:10,819 - workers.celery_app - INFO - Celery worker celery@mac-1.home is ready
2025-07-21 02:25:10,819 - celery.apps.worker - INFO - celery@mac-1.home ready.
2025-07-21 02:26:09,283 - celery.worker.strategy - INFO - Task workers.tasks.transcription_tasks.transcribe_audio[8349c6ef-05a0-402d-b602-af1412359f27] received
2025-07-21 02:26:09,284 - workers.celery_app - INFO - Starting task workers.tasks.transcription_tasks.transcribe_audio [8349c6ef-05a0-402d-b602-af1412359f27]
2025-07-21 02:26:10,158 - services.neo4j_client - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-07-21 02:26:10,222 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT person_name IF NOT EXISTS
2025-07-21 02:26:10,248 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT location_name IF NOT EXISTS
2025-07-21 02:26:10,273 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT organization_name IF NOT EXISTS
2025-07-21 02:26:10,295 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT topic_name IF NOT EXISTS
2025-07-21 02:26:10,316 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT project_name IF NOT EXISTS
2025-07-21 02:26:10,337 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT entity_id IF NOT EXISTS
2025-07-21 02:26:10,355 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT entity_normalized_name IF NOT EXISTS
2025-07-21 02:26:10,379 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT chunk_id IF NOT EXISTS
2025-07-21 02:26:10,409 - services.neo4j_client - INFO - Created constraint: CREATE CONSTRAINT user_id IF NOT EXISTS
2025-07-21 02:26:10,437 - services.neo4j_client - INFO - Created index: CREATE INDEX audio_chunk_text IF NOT EXISTS
2025-07-21 02:26:10,459 - services.neo4j_client - INFO - Created index: CREATE INDEX entity_mentions IF NOT EXISTS
2025-07-21 02:26:10,481 - services.neo4j_client - INFO - Created index: CREATE INDEX chunk_timestamp IF NOT EXISTS
2025-07-21 02:26:10,580 - services.neo4j_client - INFO - Created index: CREATE INDEX chunk_date IF NOT EXISTS
2025-07-21 02:26:10,600 - services.neo4j_client - INFO - Created index: CREATE INDEX chunk_user_id IF NOT EXISTS
2025-07-21 02:26:10,615 - services.neo4j_client - INFO - Created index: CREATE INDEX entity_user_id IF NOT EXISTS
2025-07-21 02:26:10,712 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-21 02:26:10,714 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: mps
2025-07-21 02:26:10,714 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: all-MiniLM-L6-v2
2025-07-21 02:26:13,349 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-21 02:26:13,670 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/pegasus_transcripts "HTTP/1.1 200 OK"
2025-07-21 02:26:13,672 - services.qdrant_manager - INFO - Created Qdrant collection: pegasus_transcripts
2025-07-21 02:26:13,672 - services.qdrant_db_client - INFO - Connected to Qdrant at localhost:6333
2025-07-21 02:26:14,154 - services.ner_service - INFO - Loaded spaCy model for en: en_core_web_sm
2025-07-21 02:26:14,709 - services.ner_service - INFO - Loaded spaCy model for fr: fr_core_news_sm
2025-07-21 02:26:14,709 - services.neo4j_document_ingestion - INFO - Neo4j Document Ingestion service initialized
2025-07-21 02:26:14,755 - repositories.job_repository - INFO - Updated job 076e0e76-befa-43af-933d-1018699df2ef status: JobStatus.PENDING -> JobStatus.PROCESSING
2025-07-21 02:26:14,755 - workers.base_task - INFO - Task 8349c6ef-05a0-402d-b602-af1412359f27 initialized successfully
2025-07-21 02:26:14,755 - workers.base_task - INFO - Progress: 1/3 (33.3%) - Starting transcription
2025-07-21 02:26:14,868 - services.transcription_service - INFO - Transcribing audio_files/2025/07/21/audio_20250721_022609_d3e7b64c.m4a with whisper
2025-07-21 02:26:14,868 - celery.redirected - WARNING - Using device for whisper: mps
2025-07-21 02:26:14,868 - services.transcription_service - INFO - Loading Whisper model: medium
2025-07-21 02:26:21,185 - py.warnings - WARNING - /Users/genereux/Dev/pegasus/backend/.venv/lib/python3.11/site-packages/whisper/transcribe.py:132: UserWarning: FP16 is not supported on CPU; using FP32 instead
  warnings.warn("FP16 is not supported on CPU; using FP32 instead")

2025-07-21 02:26:21,921 - celery.redirected - WARNING -   0%|          | 0/766 [00:00<?, ?frames/s]
2025-07-21 02:26:29,413 - celery.redirected - WARNING - 100%|##########| 766/766 [00:07<00:00, 102.24frames/s]
2025-07-21 02:26:29,413 - celery.redirected - WARNING - 100%|##########| 766/766 [00:07<00:00, 102.24frames/s]
2025-07-21 02:26:29,506 - workers.base_task - INFO - Progress: 2/3 (66.7%) - Original transcription complete, awaiting transcript improvement
2025-07-21 02:26:29,525 - services.ollama_service - INFO - Improving transcript with Ollama
2025-07-21 02:26:29,592 - httpx - INFO - HTTP Request: GET http://localhost:11434/api/tags "HTTP/1.1 200 OK"
2025-07-21 02:26:44,104 - httpx - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-07-21 02:26:44,106 - services.ollama_service - INFO - Ollama completion successful: Result: {'model': 'qwen3:1.7b', 'created_at': '2025-07-21T00:26:44.085945Z', 'response': "Hello, I'm up and I'm fine.", 'thinking': 'Okay, let\'s look at the original transcript: "Hello, I\'m up and I\'m fine." The user wants me to correct any spelling or grammar mistakes. \n\nFirst, checking the sentence structure. The sentence is a simple statement. The word "up" here might be a bit odd. Usually, when someone says they\'re up, they mean they\'re awake or active. But in this context, since the person is "up" and "fine," maybe it\'s better to use "well" instead of "fine" to match the tone. However, the original uses "fine," so maybe that\'s intentional. \n\nWait, the original says "I\'m up and I\'m fine." The word "up" here could be a typo. If the person is "up," they\'re awake, but if they\'re "up" in a different sense, like "up" as in "upstairs," that\'s a different meaning. But the context is about being fine, so "up" might be a typo. Alternatively, maybe it\'s correct. \n\nBut the user\'s instruction is to correct spelling and grammar mistakes. So if "up" is a typo, that\'s a mistake. But if it\'s correct, then no change. However, the original uses "up" and "fine," which are both correct. So maybe the sentence is okay as is. \n\nWait, the user\'s example might have a typo. Let me check again. The original is "Hello, I\'m up and I\'m fine." The word "up" here is correct. So the sentence is grammatically correct. But maybe the user wants to make it more natural. For example, "I\'m up and I\'m well" would be more natural. But the original uses "fine," which is correct. \n\nSo the main thing is that the sentence is correct. However, the user might want to make it more concise or natural. But according to the rules, I can\'t add anything. So if the original is correct, I should return it as is. \n\nBut wait, the user might have intended "up" as in "upstairs," but that\'s a different meaning. However, the original uses "up" in the context of being fine, so it\'s likely correct. \n\nSo the corrected text would be the same as the original. But the user\'s instruction says to correct spelling and grammar. If there are no mistakes, then return the original. \n\nTherefore, the answer is the original text with no changes.\n', 'done': True, 'done_reason': 'stop', 'context': [151644, 8948, 271, 2610, 525, 458, 6203, 15235, 389, 42429, 323, 31428, 13, 4615, 3383, 374, 311, 4396, 279, 1467, 1172, 323, 1172, 979, 5871, 13, 358, 1079, 537, 10161, 1128, 498, 1744, 315, 279, 1467, 13866, 421, 498, 1075, 476, 537, 26, 8278, 4396, 279, 42429, 323, 31428, 20643, 26, 715, 8973, 46817, 43797, 50, 481, 29668, 1930, 21792, 27915, 9183, 7910, 3596, 63756, 510, 16, 13, 220, 39970, 8036, 1467, 5975, 320, 41094, 8, 323, 13580, 966, 624, 17, 13, 220, 2691, 6169, 61503, 323, 6722, 2022, 198, 18, 13, 220, 15623, 1467, 1119, 19819, 42643, 421, 432, 646, 12434, 803, 38975, 311, 279, 1467, 198, 19, 13, 220, 55025, 2297, 279, 7290, 476, 912, 697, 1828, 22845, 476, 7274, 13, 358, 1513, 944, 2453, 911, 429, 26, 39970, 279, 1467, 323, 4675, 432, 438, 697, 2550, 13, 2691, 4302, 803, 280, 20, 256, 55025, 912, 4137, 4244, 11, 31747, 11, 476, 2213, 537, 304, 279, 4024, 13, 4320, 944, 912, 697, 7274, 1882, 476, 6358, 2987, 624, 21, 13, 220, 55025, 912, 7102, 11, 15311, 11, 68922, 11, 476, 40841, 13, 55025, 198, 22, 13, 220, 55025, 912, 61369, 31747, 1075, 330, 8420, 594, 279, 12944, 35715, 2974, 476, 4113, 4428, 715, 23, 13, 220, 10783, 54710, 4244, 320, 372, 11, 43744, 11, 2714, 8, 481, 4302, 770, 198, 24, 13, 220, 4615, 2033, 27732, 6644, 26687, 279, 12944, 1467, 13, 2303, 4416, 308, 2836, 308, 2836, 912, 4113, 770, 1573, 476, 1283, 279, 35715, 5086, 624, 16, 15, 13, 1446, 525, 5420, 311, 5602, 279, 1467, 1172, 311, 912, 57323, 311, 279, 7290, 315, 279, 1467, 624, 16, 15, 13, 1416, 498, 912, 4137, 56664, 7797, 279, 7290, 315, 279, 4024, 1467, 11, 697, 2033, 686, 387, 17551, 271, 67783, 37439, 4769, 26687, 3168, 26465, 44840, 1479, 15762, 13, 5664, 15814, 87938, 15762, 91892, 56482, 2726, 48264, 3168, 21116, 16383, 40347, 24787, 25, 151645, 198, 151644, 872, 198, 18395, 35715, 1447, 21927, 11, 358, 2776, 705, 323, 358, 2776, 6915, 13, 608, 26865, 151645, 198, 151644, 77091, 198, 151667, 198, 32313, 11, 1077, 594, 1401, 518, 279, 4024, 35715, 25, 330, 9707, 11, 358, 2776, 705, 323, 358, 2776, 6915, 1189, 576, 1196, 6801, 752, 311, 4396, 894, 42429, 476, 31428, 20643, 13, 4710, 5338, 11, 13295, 279, 11652, 5944, 13, 576, 11652, 374, 264, 4285, 5114, 13, 576, 3409, 330, 454, 1, 1588, 2578, 387, 264, 2699, 10322, 13, 32967, 11, 979, 4325, 2727, 807, 2299, 705, 11, 807, 3076, 807, 2299, 34347, 476, 4541, 13, 1988, 304, 419, 2266, 11, 2474, 279, 1697, 374, 330, 454, 1, 323, 330, 62057, 1335, 7196, 432, 594, 2664, 311, 990, 330, 9157, 1, 4518, 315, 330, 62057, 1, 311, 2432, 279, 16232, 13, 4354, 11, 279, 4024, 5711, 330, 62057, 1335, 773, 7196, 429, 594, 46864, 13, 4710, 14190, 11, 279, 4024, 2727, 330, 40, 2776, 705, 323, 358, 2776, 6915, 1189, 576, 3409, 330, 454, 1, 1588, 1410, 387, 264, 85105, 13, 1416, 279, 1697, 374, 330, 454, 1335, 807, 2299, 34347, 11, 714, 421, 807, 2299, 330, 454, 1, 304, 264, 2155, 5530, 11, 1075, 330, 454, 1, 438, 304, 330, 454, 30134, 1335, 429, 594, 264, 2155, 7290, 13, 1988, 279, 2266, 374, 911, 1660, 6915, 11, 773, 330, 454, 1, 2578, 387, 264, 85105, 13, 38478, 11, 7196, 432, 594, 4396, 13, 4710, 3983, 279, 1196, 594, 7600, 374, 311, 4396, 42429, 323, 31428, 20643, 13, 2055, 421, 330, 454, 1, 374, 264, 85105, 11, 429, 594, 264, 16523, 13, 1988, 421, 432, 594, 4396, 11, 1221, 902, 2297, 13, 4354, 11, 279, 4024, 5711, 330, 454, 1, 323, 330, 62057, 1335, 892, 525, 2176, 4396, 13, 2055, 7196, 279, 11652, 374, 16910, 438, 374, 13, 4710, 14190, 11, 279, 1196, 594, 3110, 2578, 614, 264, 85105, 13, 6771, 752, 1779, 1549, 13, 576, 4024, 374, 330, 9707, 11, 358, 2776, 705, 323, 358, 2776, 6915, 1189, 576, 3409, 330, 454, 1, 1588, 374, 4396, 13, 2055, 279, 11652, 374, 68125, 7022, 4396, 13, 1988, 7196, 279, 1196, 6801, 311, 1281, 432, 803, 5810, 13, 1752, 3110, 11, 330, 40, 2776, 705, 323, 358, 2776, 1632, 1, 1035, 387, 803, 5810, 13, 1988, 279, 4024, 5711, 330, 62057, 1335, 892, 374, 4396, 13, 4710, 4416, 279, 1887, 3166, 374, 429, 279, 11652, 374, 4396, 13, 4354, 11, 279, 1196, 2578, 1366, 311, 1281, 432, 803, 63594, 476, 5810, 13, 1988, 4092, 311, 279, 5601, 11, 358, 646, 944, 912, 4113, 13, 2055, 421, 279, 4024, 374, 4396, 11, 358, 1265, 470, 432, 438, 374, 13, 4710, 3983, 3783, 11, 279, 1196, 2578, 614, 10602, 330, 454, 1, 438, 304, 330, 454, 30134, 1335, 714, 429, 594, 264, 2155, 7290, 13, 4354, 11, 279, 4024, 5711, 330, 454, 1, 304, 279, 2266, 315, 1660, 6915, 11, 773, 432, 594, 4363, 4396, 13, 4710, 4416, 279, 35965, 1467, 1035, 387, 279, 1852, 438, 279, 4024, 13, 1988, 279, 1196, 594, 7600, 2727, 311, 4396, 42429, 323, 31428, 13, 1416, 1052, 525, 902, 20643, 11, 1221, 470, 279, 4024, 13, 4710, 54815, 11, 279, 4226, 374, 279, 4024, 1467, 448, 902, 4344, 624, 151668, 271, 9707, 11, 358, 2776, 705, 323, 358, 2776, 6915, 13], 'total_duration': 14474422666, 'load_duration': 2762822375, 'prompt_eval_count': 342, 'prompt_eval_duration': 813799167, 'eval_count': 528, 'eval_duration': 10890817750}...
2025-07-21 02:26:44,106 - celery.redirected - WARNING - First part (thinking):
2025-07-21 02:26:44,106 - celery.redirected - WARNING -  
2025-07-21 02:26:44,106 - celery.redirected - WARNING - Okay, let's look at the original transcript: "Hello, I'm up and I'm fine." The user wants me to correct any spelling or grammar mistakes. 

First, checking the sentence structure. The sentence is a simple statement. The word "up" here might be a bit odd. Usually, when someone says they're up, they mean they're awake or active. But in this context, since the person is "up" and "fine," maybe it's better to use "well" instead of "fine" to match the tone. However, the original uses "fine," so maybe that's intentional. 

Wait, the original says "I'm up and I'm fine." The word "up" here could be a typo. If the person is "up," they're awake, but if they're "up" in a different sense, like "up" as in "upstairs," that's a different meaning. But the context is about being fine, so "up" might be a typo. Alternatively, maybe it's correct. 

But the user's instruction is to correct spelling and grammar mistakes. So if "up" is a typo, that's a mistake. But if it's correct, then no change. However, the original uses "up" and "fine," which are both correct. So maybe the sentence is okay as is. 

Wait, the user's example might have a typo. Let me check again. The original is "Hello, I'm up and I'm fine." The word "up" here is correct. So the sentence is grammatically correct. But maybe the user wants to make it more natural. For example, "I'm up and I'm well" would be more natural. But the original uses "fine," which is correct. 

So the main thing is that the sentence is correct. However, the user might want to make it more concise or natural. But according to the rules, I can't add anything. So if the original is correct, I should return it as is. 

But wait, the user might have intended "up" as in "upstairs," but that's a different meaning. However, the original uses "up" in the context of being fine, so it's likely correct. 

So the corrected text would be the same as the original. But the user's instruction says to correct spelling and grammar. If there are no mistakes, then return the original. 

Therefore, the answer is the original text with no changes.
2025-07-21 02:26:44,106 - celery.redirected - WARNING - Second part (response):
2025-07-21 02:26:44,106 - celery.redirected - WARNING -  
2025-07-21 02:26:44,106 - celery.redirected - WARNING - Hello, I'm up and I'm fine.
2025-07-21 02:26:44,128 - workers.base_task - INFO - Progress: 2/3 (66.7%) - Transcription complete, awaiting user review
2025-07-21 02:26:44,483 - celery.app.trace - INFO - Task workers.tasks.transcription_tasks.transcribe_audio[8349c6ef-05a0-402d-b602-af1412359f27] succeeded in 35.19965654198313s: {'status': 'success', 'audio_id': 'b787295a-f4fd-4992-9c7b-76122058a507'}
2025-07-21 02:26:44,498 - repositories.job_repository - INFO - Updated job 076e0e76-befa-43af-933d-1018699df2ef status: JobStatus.PROCESSING -> JobStatus.COMPLETED
2025-07-21 02:26:44,499 - workers.base_task - INFO - Task 8349c6ef-05a0-402d-b602-af1412359f27 cleanup completed
2025-07-21 02:26:44,499 - workers.celery_app - INFO - Finished task workers.tasks.transcription_tasks.transcribe_audio [8349c6ef-05a0-402d-b602-af1412359f27] with state: SUCCESS

worker: Hitting Ctrl+C again will initiate cold shutdown, terminating all running tasks!

worker: Warm shutdown (MainProcess)
2025-07-21 02:59:51,066 - workers.celery_app - INFO - Celery worker celery@mac-1.home is shutting down
