INFO:__main__:Starting Pegasus Brain with settings...
api_title='Pegasus Backend' api_version='0.1.0' database_url='postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' auto_migrate_on_startup=True neo4j_uri='bolt://localhost:7687' neo4j_user='neo4j' neo4j_password='pegasus_neo4j_password' chromadb_host='localhost' chromadb_port=8001 chromadb_collection_name='pegasus_transcripts' qdrant_host='localhost' qdrant_port=6333 qdrant_collection_name='pegasus_transcripts' redis_url='redis://localhost:6379/0' celery_broker_url='redis://localhost:6379/0' celery_result_backend='db+postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' max_workers=4 task_timeout=300 embedding_model='all-MiniLM-L6-v2' embedding_dimension=384 spacy_model_en='en_core_web_sm' spacy_model_fr='fr_core_news_sm' plugin_directory='./plugins' plugin_enabled=True audio_storage_path='./audio_files' max_file_size_mb=100 allowed_audio_formats=['m4a', 'mp3', 'wav', 'ogg', 'flac', 'aac'] transcription_engine='whisper' whisper_model='medium' whisper_device='mps' deepgram_api_key='your_deepgram_api_key_here' deepgram_api_url='https://api.deepgram.com/v1/listen' llm_provider='vertex_adk' llm_timeout=120.0 ollama_model='qwen3:1.7b' ollama_timeout=120.0 ollama_base_url='http://localhost:11434' google_generative_ai_api_key='AIzaSyAyGSnQiO4t2dBCAR0XpyC77Gx46U5h_EU' google_generative_ai_model='gemini-2.5-flash' gemini_api_key=None vertex_ai_project_id='gen-lang-client-0319023828' vertex_ai_location='europe-west4' vertex_ai_agent_engine_id='3290583215235923968' vertex_ai_model='gemini-2.5-flash' vertex_ai_timeout=60.0 vertex_ai_temperature=0.7 vertex_ai_max_tokens=2048 vertex_ai_top_k=40 vertex_ai_top_p=0.95 vertex_ai_user_id='flutter_user' google_application_credentials=None openai_api_key=None openai_model='gpt-3.5-turbo' openai_api_url='https://api.openai.com/v1' llm_api_key=None enhancement_prompt_template="You are a transcript editor. Your task is to correct the following transcript by:\n1. Adding proper punctuation where needed\n2. Fixing obvious grammatical errors\n3. Ensuring proper capitalization\n\nIMPORTANT RULES:\n- Do NOT change the meaning or content\n- Do NOT add or remove any words (except for fixing obvious typos)\n- Keep the original speaker's style and tone\n- Only output the corrected transcript, nothing else\n\nOriginal transcript: {transcript}\n\nCorrected transcript:" conversation_history_lookback_days=1 conversation_processing_delay_minutes=1 recent_transcript_window_hours=25 max_upload_size_bytes=104857600 allowed_mime_types=['audio/mp4', 'audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/flac', 'audio/aac', 'audio/x-m4a'] enable_request_logging=True log_directory='./logs' log_max_body_size=10000 log_binary_content=False log_excluded_paths=['/health', '/docs', '/redoc', '/openapi.json', '/favicon.ico'] log_excluded_methods=[]
INFO:     Will watch for changes in these directories: ['/Users/genereux/Dev/pegasus/backend']
INFO:     Uvicorn running on http://0.0.0.0:9000 (Press CTRL+C to quit)
INFO:     Started reloader process [99906] using WatchFiles
INFO:__mp_main__:Starting Pegasus Brain with settings...
api_title='Pegasus Backend' api_version='0.1.0' database_url='postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' auto_migrate_on_startup=True neo4j_uri='bolt://localhost:7687' neo4j_user='neo4j' neo4j_password='pegasus_neo4j_password' chromadb_host='localhost' chromadb_port=8001 chromadb_collection_name='pegasus_transcripts' qdrant_host='localhost' qdrant_port=6333 qdrant_collection_name='pegasus_transcripts' redis_url='redis://localhost:6379/0' celery_broker_url='redis://localhost:6379/0' celery_result_backend='db+postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' max_workers=4 task_timeout=300 embedding_model='all-MiniLM-L6-v2' embedding_dimension=384 spacy_model_en='en_core_web_sm' spacy_model_fr='fr_core_news_sm' plugin_directory='./plugins' plugin_enabled=True audio_storage_path='./audio_files' max_file_size_mb=100 allowed_audio_formats=['m4a', 'mp3', 'wav', 'ogg', 'flac', 'aac'] transcription_engine='whisper' whisper_model='medium' whisper_device='mps' deepgram_api_key='your_deepgram_api_key_here' deepgram_api_url='https://api.deepgram.com/v1/listen' llm_provider='vertex_adk' llm_timeout=120.0 ollama_model='qwen3:1.7b' ollama_timeout=120.0 ollama_base_url='http://localhost:11434' google_generative_ai_api_key='AIzaSyAyGSnQiO4t2dBCAR0XpyC77Gx46U5h_EU' google_generative_ai_model='gemini-2.5-flash' gemini_api_key=None vertex_ai_project_id='gen-lang-client-0319023828' vertex_ai_location='europe-west4' vertex_ai_agent_engine_id='3290583215235923968' vertex_ai_model='gemini-2.5-flash' vertex_ai_timeout=60.0 vertex_ai_temperature=0.7 vertex_ai_max_tokens=2048 vertex_ai_top_k=40 vertex_ai_top_p=0.95 vertex_ai_user_id='flutter_user' google_application_credentials=None openai_api_key=None openai_model='gpt-3.5-turbo' openai_api_url='https://api.openai.com/v1' llm_api_key=None enhancement_prompt_template="You are a transcript editor. Your task is to correct the following transcript by:\n1. Adding proper punctuation where needed\n2. Fixing obvious grammatical errors\n3. Ensuring proper capitalization\n\nIMPORTANT RULES:\n- Do NOT change the meaning or content\n- Do NOT add or remove any words (except for fixing obvious typos)\n- Keep the original speaker's style and tone\n- Only output the corrected transcript, nothing else\n\nOriginal transcript: {transcript}\n\nCorrected transcript:" conversation_history_lookback_days=1 conversation_processing_delay_minutes=1 recent_transcript_window_hours=25 max_upload_size_bytes=104857600 allowed_mime_types=['audio/mp4', 'audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/flac', 'audio/aac', 'audio/x-m4a'] enable_request_logging=True log_directory='./logs' log_max_body_size=10000 log_binary_content=False log_excluded_paths=['/health', '/docs', '/redoc', '/openapi.json', '/favicon.ico'] log_excluded_methods=[]
INFO:main:Starting Pegasus Brain with settings...
api_title='Pegasus Backend' api_version='0.1.0' database_url='postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' auto_migrate_on_startup=True neo4j_uri='bolt://localhost:7687' neo4j_user='neo4j' neo4j_password='pegasus_neo4j_password' chromadb_host='localhost' chromadb_port=8001 chromadb_collection_name='pegasus_transcripts' qdrant_host='localhost' qdrant_port=6333 qdrant_collection_name='pegasus_transcripts' redis_url='redis://localhost:6379/0' celery_broker_url='redis://localhost:6379/0' celery_result_backend='db+postgresql://pegasus_user:pegasus_password@localhost:5432/pegasus_db' max_workers=4 task_timeout=300 embedding_model='all-MiniLM-L6-v2' embedding_dimension=384 spacy_model_en='en_core_web_sm' spacy_model_fr='fr_core_news_sm' plugin_directory='./plugins' plugin_enabled=True audio_storage_path='./audio_files' max_file_size_mb=100 allowed_audio_formats=['m4a', 'mp3', 'wav', 'ogg', 'flac', 'aac'] transcription_engine='whisper' whisper_model='medium' whisper_device='mps' deepgram_api_key='your_deepgram_api_key_here' deepgram_api_url='https://api.deepgram.com/v1/listen' llm_provider='vertex_adk' llm_timeout=120.0 ollama_model='qwen3:1.7b' ollama_timeout=120.0 ollama_base_url='http://localhost:11434' google_generative_ai_api_key='AIzaSyAyGSnQiO4t2dBCAR0XpyC77Gx46U5h_EU' google_generative_ai_model='gemini-2.5-flash' gemini_api_key=None vertex_ai_project_id='gen-lang-client-0319023828' vertex_ai_location='europe-west4' vertex_ai_agent_engine_id='3290583215235923968' vertex_ai_model='gemini-2.5-flash' vertex_ai_timeout=60.0 vertex_ai_temperature=0.7 vertex_ai_max_tokens=2048 vertex_ai_top_k=40 vertex_ai_top_p=0.95 vertex_ai_user_id='flutter_user' google_application_credentials=None openai_api_key=None openai_model='gpt-3.5-turbo' openai_api_url='https://api.openai.com/v1' llm_api_key=None enhancement_prompt_template="You are a transcript editor. Your task is to correct the following transcript by:\n1. Adding proper punctuation where needed\n2. Fixing obvious grammatical errors\n3. Ensuring proper capitalization\n\nIMPORTANT RULES:\n- Do NOT change the meaning or content\n- Do NOT add or remove any words (except for fixing obvious typos)\n- Keep the original speaker's style and tone\n- Only output the corrected transcript, nothing else\n\nOriginal transcript: {transcript}\n\nCorrected transcript:" conversation_history_lookback_days=1 conversation_processing_delay_minutes=1 recent_transcript_window_hours=25 max_upload_size_bytes=104857600 allowed_mime_types=['audio/mp4', 'audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/flac', 'audio/aac', 'audio/x-m4a'] enable_request_logging=True log_directory='./logs' log_max_body_size=10000 log_binary_content=False log_excluded_paths=['/health', '/docs', '/redoc', '/openapi.json', '/favicon.ico'] log_excluded_methods=[]
INFO:     Started server process [99915]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:api.audio_router:Audio file uploaded successfully: b787295a-f4fd-4992-9c7b-76122058a507
INFO:     192.168.1.18:62091 - "POST /api/audio/upload HTTP/1.1" 200 OK
INFO:api.audio_router:Dispatching transcription task for audio b787295a-f4fd-4992-9c7b-76122058a507
INFO:watchfiles.main:3 changes detected
INFO:api.audio_router:Dispatched transcription task 8349c6ef-05a0-402d-b602-af1412359f27 for audio b787295a-f4fd-4992-9c7b-76122058a507
INFO:     192.168.1.18:62091 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62091 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62091 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62091 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62091 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62113 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62113 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:watchfiles.main:1 change detected
INFO:     192.168.1.18:62113 - "GET /api/audio/b787295a-f4fd-4992-9c7b-76122058a507 HTTP/1.1" 200 OK
INFO:watchfiles.main:1 change detected
INFO:watchfiles.main:1 change detected
INFO:watchfiles.main:3 changes detected
INFO:watchfiles.main:3 changes detected
INFO:watchfiles.main:3 changes detected
INFO:watchfiles.main:3 changes detected
INFO:watchfiles.main:6 changes detected
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [99915]
INFO:     Stopping reloader process [99906]
